{# 自定义侧边栏：文章详情页显示同分类文章，其他页面显示所有文章 #}

{% if page.categories and page.categories.length > 0 %}
  {# 文章详情页：显示当前分类的所有文章 #}
  {% set currentCategory = page.categories.toArray()[0] %}
  <div class="links-of-blogroll motion-element sidebar-category-posts">
    <div class="links-of-blogroll-title">
      <i class="fa fa-folder-open fa-fw"></i>
      {{ currentCategory.name }}
      <span style="font-size: 0.85em; color: #888; font-weight: normal;">({{ currentCategory.posts.length }}篇)</span>
    </div>
    <ul class="links-of-blogroll-list">
      {% for post in currentCategory.posts.sort('date', -1).toArray() %}
        <li class="links-of-blogroll-item {% if post.path === page.path %}current-post{% endif %}">
          <a href="{{ url_for(post.path) }}" title="{{ post.title }}" {% if post.path === page.path %}class="current"{% endif %}>
            {{ post.title }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
{% else %}
  {# 非文章页：显示所有文章 #}
  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-book fa-fw"></i>
      所有文章
    </div>
    <ul class="links-of-blogroll-list">
      {% for post in site.posts.sort('date', -1).toArray() %}
        <li class="links-of-blogroll-item">
          <a href="{{ url_for(post.path) }}" title="{{ post.title }}">
            <span style="color: #999; font-size: 0.9em;">[{{ post.categories.toArray()[0].name }}]</span>
            {{ post.title }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
{% endif %}